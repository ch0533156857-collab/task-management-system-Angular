<div class="task-edit-wrapper">
  @if (isLoading()) {
    <div class="task-form-container graffiti-card">
      <div class="center">
        <app-loading-spinner></app-loading-spinner>
        <p class="loading-text">Loading task details...</p>
      </div>
    </div>
  } @else {
    <div class="task-form-container graffiti-card">
      <div class="form-header">
        <h2 class="form-title">âœï¸ EDIT TASK</h2>
        <div class="title-underline"></div>
      </div>

      <form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label class="form-label">Task Title</label>
          <input type="text" formControlName="title" class="form-input" placeholder="Task title">
          @if (taskForm.get('title')?.hasError('required') && taskForm.get('title')?.touched) {
            <span class="form-error">Title is required</span>
          }
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Status</label>
            <select formControlName="status" class="form-select">
              <option value="TODO">ğŸ“‹ To Do</option>
              <option value="IN_PROGRESS">ğŸš€ In Progress</option>
              <option value="DONE">âœ… Done</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Priority</label>
            <select formControlName="priority" class="form-select">
              <option value="LOW">ğŸŸ¢ Low</option>
              <option value="MEDIUM">ğŸŸ¡ Medium</option>
              <option value="HIGH">ğŸ”´ High</option>
            </select>
          </div>
        </div>

        @if (errorMessage()) {
          <p class="error-message">âš ï¸ {{ errorMessage() }}</p>
        }

        <div class="actions">
          <button type="button" (click)="onCancel()" [disabled]="isLoading()" class="graffiti-btn graffiti-btn-secondary">
            Cancel
          </button>
          <button type="submit" [disabled]="taskForm.invalid || isLoading()" class="graffiti-btn graffiti-btn-primary spray-paint-btn">
            @if (isLoading()) { 
              <app-loading-spinner [isInline]="true"></app-loading-spinner> 
            } @else { 
              ğŸ’¾ Update Task 
            }
          </button>
        </div>
      </form>
    </div>
  }

  <hr class="divider">
  <app-comment-list [taskId]="taskIdNumber()"></app-comment-list>
</div>